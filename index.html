<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greek Bird - 2D & 3D</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=GFS+Didot&display=swap');

        body {
            font-family: 'GFS Didot', serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
        }

        canvas {
            display: block;
        }

        #modeToggle {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            background-color: #b8860b;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
        }

        #modeToggle:hover {
            background-color: #a67c0a;
        }

        #gameOverText {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #b8860b;
            display: none;
            z-index: 2;
        }

        #touchToStart {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            color: #b8860b;
            display: block;
            z-index: 2;
        }

        #startButton {
            font-size: 24px;
            padding: 10px 20px;
            background-color: #b8860b;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #startButton:hover {
            background-color: #a67c0a;
        }
    </style>
</head>
<body>
    <!-- Botão para alternar entre 2D e 3D -->
    <button id="modeToggle">Alternar para 3D</button>

    <!-- Tela do jogo 2D -->
    <canvas id="gameCanvas2D"></canvas>
    <div id="gameOverText">Game Over</div>
    <div id="touchToStart">
        <button id="startButton">Start</button>
    </div>

    <!-- Tela do jogo 3D -->
    <div id="gameCanvas3D" style="display: none;"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r146/three.min.js"></script>
    <script>
        // Configurações globais
        let is3DMode = false;
        let gameStarted = false;
        let gameOver = false;
        let score = 0;

        // Elementos da interface
        const modeToggle = document.getElementById('modeToggle');
        const gameCanvas2D = document.getElementById('gameCanvas2D');
        const gameCanvas3D = document.getElementById('gameCanvas3D');
        const gameOverText = document.getElementById('gameOverText');
        const touchToStart = document.getElementById('touchToStart');
        const startButton = document.getElementById('startButton');

        // Configurações do jogo 2D
        const ctx2D = gameCanvas2D.getContext('2d');
        gameCanvas2D.width = window.innerWidth;
        gameCanvas2D.height = window.innerHeight;

        const bird2D = {
            x: 50,
            y: gameCanvas2D.height / 2,
            width: 50,
            height: 50,
            gravity: 0.15,
            lift: -6,
            velocity: 0
        };

        const columns2D = [];
        const columnWidth2D = 60;
        const gapHeight2D = 200;

        // Configurações do jogo 3D
        let scene3D, camera3D, renderer3D, bird3D, columns3D = [];
        const columnWidth3D = 1;
        const gapHeight3D = 4;

        // Função para alternar entre 2D e 3D
        modeToggle.addEventListener('click', () => {
            is3DMode = !is3DMode;
            modeToggle.textContent = is3DMode ? "Alternar para 2D" : "Alternar para 3D";
            gameCanvas2D.style.display = is3DMode ? "none" : "block";
            gameCanvas3D.style.display = is3DMode ? "block" : "none";

            if (is3DMode && !scene3D) {
                init3D();
            }
        });

        // Inicialização do modo 3D
        function init3D() {
            scene3D = new THREE.Scene();
            camera3D = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer3D = new THREE.WebGLRenderer();
            renderer3D.setSize(window.innerWidth, window.innerHeight);
            gameCanvas3D.appendChild(renderer3D.domElement);

            // Adicionar pássaro (esfera)
            const birdGeometry = new THREE.SphereGeometry(0.5, 32, 32);
            const birdMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            bird3D = new THREE.Mesh(birdGeometry, birdMaterial);
            bird3D.position.y = 0;
            scene3D.add(bird3D);

            // Configurar câmera
            camera3D.position.z = 10;
            camera3D.position.y = 0;

            // Adicionar luz
            const light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(5, 5, 5).normalize();
            scene3D.add(light);

            // Iniciar animação 3D
            animate3D();
        }

        // Função para atualizar o jogo 2D
        function update2D() {
            if (!gameStarted || gameOver) return;

            // Atualizar pássaro
            bird2D.velocity += bird2D.gravity;
            bird2D.y += bird2D.velocity;

            // Verificar colisões
            if (bird2D.y + bird2D.height > gameCanvas2D.height || bird2D.y < 0) {
                gameOver = true;
                gameOverText.style.display = "block";
                touchToStart.style.display = "block";
            }

            // Atualizar colunas
            for (let i = columns2D.length - 1; i >= 0; i--) {
                columns2D[i].x -= 3;

                // Verificar colisões com colunas
                if (
                    bird2D.x + bird2D.width > columns2D[i].x &&
                    bird2D.x < columns2D[i].x + columnWidth2D &&
                    (bird2D.y < columns2D[i].gapY || bird2D.y + bird2D.height > columns2D[i].gapY + gapHeight2D)
                ) {
                    gameOver = true;
                    gameOverText.style.display = "block";
                    touchToStart.style.display = "block";
                }

                // Remover colunas fora da tela
                if (columns2D[i].x + columnWidth2D < 0) {
                    columns2D.splice(i, 1);
                    score++;
                }
            }

            // Adicionar novas colunas
            if (columns2D.length === 0 || columns2D[columns2D.length - 1].x < gameCanvas2D.width - 300) {
                const gapY = Math.random() * (gameCanvas2D.height - gapHeight2D - 100) + 50;
                columns2D.push({ x: gameCanvas2D.width, gapY });
            }

            // Renderizar cena 2D
            ctx2D.clearRect(0, 0, gameCanvas2D.width, gameCanvas2D.height);
            ctx2D.fillStyle = "#70c5ce";
            ctx2D.fillRect(0, 0, gameCanvas2D.width, gameCanvas2D.height);

            // Desenhar pássaro
            ctx2D.fillStyle = "#ff0000";
            ctx2D.fillRect(bird2D.x, bird2D.y, bird2D.width, bird2D.height);

            // Desenhar colunas
            ctx2D.fillStyle = "#8B4513";
            columns2D.forEach(column => {
                ctx2D.fillRect(column.x, 0, columnWidth2D, column.gapY);
                ctx2D.fillRect(column.x, column.gapY + gapHeight2D, columnWidth2D, gameCanvas2D.height - column.gapY - gapHeight2D);
            });

            // Desenhar pontuação
            ctx2D.fillStyle = "#000";
            ctx2D.font = "24px Arial";
            ctx2D.fillText("Score: " + score, 10, 30);

            if (!gameOver) requestAnimationFrame(update2D);
        }

        // Função para atualizar o jogo 3D
        function update3D() {
            if (!gameStarted || gameOver) return;

            // Atualizar pássaro
            bird3D.position.y -= bird2D.velocity * 0.1;

            // Verificar colisões
            if (bird3D.position.y < -5 || bird3D.position.y > 5) {
                gameOver = true;
                gameOverText.style.display = "block";
                touchToStart.style.display = "block";
            }

            // Atualizar colunas
            for (let i = columns3D.length - 1; i >= 0; i--) {
                columns3D[i].position.x -= 0.1;

                // Verificar colisões com colunas
                if (
                    bird3D.position.x + 0.5 > columns3D[i].position.x - columnWidth3D / 2 &&
                    bird3D.position.x - 0.5 < columns3D[i].position.x + columnWidth3D / 2 &&
                    (bird3D.position.y < columns3D[i].gapY || bird3D.position.y > columns3D[i].gapY + gapHeight3D)
                ) {
                    gameOver = true;
                    gameOverText.style.display = "block";
                    touchToStart.style.display = "block";
                }

                // Remover colunas fora da tela
                if (columns3D[i].position.x < -10) {
                    scene3D.remove(columns3D[i]);
                    columns3D.splice(i, 1);
                    score++;
                }
            }

            // Adicionar novas colunas
            if (columns3D.length === 0 || columns3D[columns3D.length - 1].position.x < 10) {
                const gapY = (Math.random() - 0.5) * 6;
                const columnGeometry = new THREE.BoxGeometry(columnWidth3D, 10, 1);
                const columnMaterial = new THREE.MeshBasicMaterial({ color: 0x8B4513 });

                const topColumn = new THREE.Mesh(columnGeometry, columnMaterial);
                topColumn.position.y = gapY + gapHeight3D / 2 + 5;
                topColumn.position.x = 10;
                scene3D.add(topColumn);
                columns3D.push(topColumn);

                const bottomColumn = new THREE.Mesh(columnGeometry, columnMaterial);
                bottomColumn.position.y = gapY - gapHeight3D / 2 - 5;
                bottomColumn.position.x = 10;
                scene3D.add(bottomColumn);
                columns3D.push(bottomColumn);
            }

            // Renderizar cena 3D
            renderer3D.render(scene3D, camera3D);

            if (!gameOver) requestAnimationFrame(update3D);
        }

        // Função para reiniciar o jogo
        function restartGame() {
            gameStarted = true;
            gameOver = false;
            score = 0;
            gameOverText.style.display = "none";
            touchToStart.style.display = "none";

            if (is3DMode) {
                bird3D.position.y = 0;
                columns3D.forEach(column => scene3D.remove(column));
                columns3D = [];
                update3D();
            } else {
                bird2D.y = gameCanvas2D.height / 2;
                bird2D.velocity = 0;
                columns2D.length = 0;
                update2D();
            }
        }

        // Evento de clique para iniciar/reiniciar o jogo
        startButton.addEventListener('click', restartGame);

        // Evento de clique para fazer o pássaro voar
        window.addEventListener('click', () => {
            if (gameStarted && !gameOver) {
                if (is3DMode) {
                    bird2D.velocity = bird2D.lift;
                } else {
                    bird2D.velocity = bird2D.lift;
                }
            }
        });
    </script>
</body>
</html>